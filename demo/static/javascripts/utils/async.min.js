(function(){function n(n){var e=!1;return function(){if(e)throw Error("Callback was already called.");e=!0,n.apply(t,arguments)}}var t,e,r={};t=this,null!=t&&(e=t.async),r.noConflict=function(){return t.async=e,r};var u=function(n,t){if(n.forEach)return n.forEach(t);for(var e=0;n.length>e;e+=1)t(n[e],e,n)},i=function(n,t){if(n.map)return n.map(t);var e=[];return u(n,function(n,r,u){e.push(t(n,r,u))}),e},c=function(n,t,e){return n.reduce?n.reduce(t,e):(u(n,function(n,r,u){e=t(e,n,r,u)}),e)},o=function(n){if(Object.keys)return Object.keys(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,r.setImmediate="undefined"!=typeof setImmediate?setImmediate:r.nextTick):"function"==typeof setImmediate?(r.setImmediate=setImmediate,r.nextTick=setImmediate):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(t,e,r){if(r=r||function(){},!t.length)return r();var i=0;u(t,function(u){e(u,n(function(n){n?(r(n),r=function(){}):(i+=1,i>=t.length&&r(null))}))})},r.forEach=r.each,r.eachSeries=function(n,t,e){if(e=e||function(){},!n.length)return e();var r=0,u=function(){t(n[r],function(t){t?(e(t),e=function(){}):(r+=1,r>=n.length?e(null):u())})};u()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,t,e,r){var u=a(t);u.apply(null,[n,e,r])},r.forEachLimit=r.eachLimit;var a=function(n){return function(t,e,r){if(r=r||function(){},!t.length||0>=n)return r();var u=0,i=0,c=0;(function o(){if(u>=t.length)return r();for(;n>c&&t.length>i;)i+=1,c+=1,e(t[i-1],function(n){n?(r(n),r=function(){}):(u+=1,c-=1,u>=t.length?r():o())})})()}},l=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(t))}},f=function(n,t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a(n)].concat(e))}},s=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(t))}},p=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e,r){u[n.index]=r,t(e)})},function(n){r(n,u)})};r.map=l(p),r.mapSeries=s(p),r.mapLimit=function(n,t,e,r){return m(t)(n,e,r)};var m=function(n){return f(n,p)};r.reduce=function(n,t,e,u){r.eachSeries(n,function(n,r){e(t,n,function(n,e){t=e,r(n)})},function(n){u(n,t)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,t,e,u){var c=i(n,function(n){return n}).reverse();r.reduce(c,t,e,u)},r.foldr=r.reduceRight;var y=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e&&u.push(n),t()})},function(){r(i(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.filter=l(y),r.filterSeries=s(y),r.select=r.filter,r.selectSeries=r.filterSeries;var v=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e||u.push(n),t()})},function(){r(i(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.reject=l(v),r.rejectSeries=s(v);var h=function(n,t,e,r){n(t,function(n,t){e(n,function(e){e?(r(n),r=function(){}):t()})},function(){r()})};r.detect=l(h),r.detectSeries=s(h),r.some=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n&&(e(!0),e=function(){}),r()})},function(){e(!1)})},r.any=r.some,r.every=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n||(e(!1),e=function(){}),r()})},function(){e(!0)})},r.all=r.every,r.sortBy=function(n,t,e){r.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);var r=function(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0};e(null,i(t.sort(r),function(n){return n.value}))})},r.auto=function(n,t){t=t||function(){};var e=o(n);if(!e.length)return t(null);var i={},a=[],l=function(n){a.unshift(n)},f=function(n){for(var t=0;a.length>t;t+=1)if(a[t]===n)return a.splice(t,1),void 0},s=function(){u(a.slice(0),function(n){n()})};l(function(){o(i).length===e.length&&(t(null,i),t=function(){})}),u(e,function(e){var a=n[e]instanceof Function?[n[e]]:n[e],p=function(n){var c=Array.prototype.slice.call(arguments,1);if(1>=c.length&&(c=c[0]),n){var a={};u(o(i),function(n){a[n]=i[n]}),a[e]=c,t(n,a),t=function(){}}else i[e]=c,r.setImmediate(s)},m=a.slice(0,Math.abs(a.length-1))||[],y=function(){return c(m,function(n,t){return n&&i.hasOwnProperty(t)},!0)&&!i.hasOwnProperty(e)};if(y())a[a.length-1](p,i);else{var v=function(){y()&&(f(v),a[a.length-1](p,i))};l(v)}})},r.waterfall=function(n,t){if(t=t||function(){},n.constructor!==Array){var e=Error("First argument to waterfall must be an array of functions");return t(e)}if(!n.length)return t();var u=function(n){return function(e){if(e)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),c=n.next();c?i.push(u(c)):i.push(t),r.setImmediate(function(){n.apply(null,i)})}}};u(r.iterator(n))()};var d=function(n,t,e){if(e=e||function(){},t.constructor===Array)n.map(t,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);1>=e.length&&(e=e[0]),t.call(null,n,e)})},e);else{var r={};n.each(o(t),function(n,e){t[n](function(t){var u=Array.prototype.slice.call(arguments,1);1>=u.length&&(u=u[0]),r[n]=u,e(t)})},function(n){e(n,r)})}};r.parallel=function(n,t){d({map:r.map,each:r.each},n,t)},r.parallelLimit=function(n,t,e){d({map:m(t),each:a(t)},n,e)},r.series=function(n,t){if(t=t||function(){},n.constructor===Array)r.mapSeries(n,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);1>=e.length&&(e=e[0]),t.call(null,n,e)})},t);else{var e={};r.eachSeries(o(n),function(t,r){n[t](function(n){var u=Array.prototype.slice.call(arguments,1);1>=u.length&&(u=u[0]),e[t]=u,r(n)})},function(n){t(n,e)})}},r.iterator=function(n){var t=function(e){var r=function(){return n.length&&n[e].apply(null,arguments),r.next()};return r.next=function(){return n.length-1>e?t(e+1):null},r};return t(0)},r.apply=function(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var g=function(n,t,e,r){var u=[];n(t,function(n,t){e(n,function(n,e){u=u.concat(e||[]),t(n)})},function(n){r(n,u)})};r.concat=l(g),r.concatSeries=s(g),r.whilst=function(n,t,e){n()?t(function(u){return u?e(u):(r.whilst(n,t,e),void 0)}):e()},r.doWhilst=function(n,t,e){n(function(u){return u?e(u):(t()?r.doWhilst(n,t,e):e(),void 0)})},r.until=function(n,t,e){n()?e():t(function(u){return u?e(u):(r.until(n,t,e),void 0)})},r.doUntil=function(n,t,e){n(function(u){return u?e(u):(t()?e():r.doUntil(n,t,e),void 0)})},r.queue=function(t,e){function i(n,t,i,c){t.constructor!==Array&&(t=[t]),u(t,function(t){var u={data:t,callback:"function"==typeof c?c:null};i?n.tasks.unshift(u):n.tasks.push(u),n.saturated&&n.tasks.length===e&&n.saturated(),r.setImmediate(n.process)})}void 0===e&&(e=1);var c=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,push:function(n,t){i(o,n,!1,t)},unshift:function(n,t){i(o,n,!0,t)},process:function(){if(o.concurrency>c&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),c+=1;var r=function(){c-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&0===o.tasks.length+c&&o.drain(),o.process()},u=n(r);t(e.data,u)}},length:function(){return o.tasks.length},running:function(){return c}};return o},r.cargo=function(n,t){var e=!1,c=[],o={tasks:c,payload:t,saturated:null,empty:null,drain:null,push:function(n,e){n.constructor!==Array&&(n=[n]),u(n,function(n){c.push({data:n,callback:"function"==typeof e?e:null}),o.saturated&&c.length===t&&o.saturated()}),r.setImmediate(o.process)},process:function a(){if(!e){if(0===c.length)return o.drain&&o.drain(),void 0;var r="number"==typeof t?c.splice(0,t):c.splice(0),l=i(r,function(n){return n.data});o.empty&&o.empty(),e=!0,n(l,function(){e=!1;var n=arguments;u(r,function(t){t.callback&&t.callback.apply(null,n)}),a()})}},length:function(){return c.length},running:function(){return e}};return o};var k=function(n){return function(t){var e=Array.prototype.slice.call(arguments,1);t.apply(null,e.concat([function(t){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&u(e,function(t){console[n](t)}))}]))}};r.log=k("log"),r.dir=k("dir"),r.memoize=function(n,t){var e={},r={};t=t||function(n){return n};var u=function(){var u=Array.prototype.slice.call(arguments),i=u.pop(),c=t.apply(null,u);c in e?i.apply(null,e[c]):c in r?r[c].push(i):(r[c]=[i],n.apply(null,u.concat([function(){e[c]=arguments;var n=r[c];delete r[c];for(var t=0,u=n.length;u>t;t++)n[t].apply(null,arguments)}])))};return u.memo=e,u.unmemoized=n,u},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.map(u,t,e)},r.timesSeries=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.mapSeries(u,t,e)},r.compose=function(){var n=Array.prototype.reverse.call(arguments);return function(){var t=this,e=Array.prototype.slice.call(arguments),u=e.pop();r.reduce(n,e,function(n,e,r){e.apply(t,n.concat([function(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);r(n,t)}]))},function(n,e){u.apply(t,[n].concat(e))})}};var A=function(n,t){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),u=r.pop();return n(t,function(n,t){n.apply(e,r.concat([t]))},u)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};r.applyEach=l(A),r.applyEachSeries=s(A),r.forever=function(n,t){function e(r){if(r){if(t)return t(r);throw r}n(e)}e()},"undefined"!=typeof define&&define.amd?define([],function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:t.async=r})();